{"name":"Ultracache","tagline":"ローカルとリモートのmemcachにキャッシュさせる的なあれ","body":"\r\nUltracache\r\n==========\r\n\r\n![うるとら](http://www.polidog.jp/images/tora.jpg)\r\n\r\nウルトラキャッシュはストレス発散とネタ的な意味をこめて、作ったPHPのライブラリです。\r\nMemacheサーバとAPサーバが別サーバのときに、いちいちmemcacheからデータを取得するのって意外とネットワークの帯域を消費するんじゃないかと僕は思ったわけです。  \r\nローカルにキャッシュがあるときはローカルから取得して、無い場合はmemcaheから取得するみたいな感じの実装です。\r\n\r\n一応Memcached以外にも対応できるようにドライバっぽく作ってあったりもします。\r\n\r\nちなみに、テストはしてないし、動作のチェックもしていません。\r\nただコードを書いただけなので、使う際は要注意してください。不具合があった場合はPull Request送ってもらえるとうれしいです。\r\n\r\nInstallation  \r\n------------\r\n\r\n    pecl install memcached\r\n    pecl install apc\r\n\r\n\r\nConfigurations\r\n--------------\r\n\t<?php\r\n\t$config = array(\r\n\t\t'remote'\t=> array( // リモート側\r\n\t\t\t'Memcached' => array(\r\n\t\t\t\t'servers' => array(\r\n\t\t\t\t\tarray('localhost',11211), // memcachedのサーバ設定とおなじ\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t),\r\n\t\t'local'\t\t=> array( // AP側(実行しているPHPの鯖)\r\n\t\t\t'Apc' => array(), // 別に設定は特になし、でも空配列じゃないとだめだよー\r\n\t\t),\r\n\t);\r\n\r\nUsage\r\n-----\r\n\r\n一応PSR-0に従っているような気がするので適当にオートローダー用していただければ良いかと思います。\r\n使い方は至って簡単。\r\n\r\n\t<?php\r\n\trequire __DIR__ . '/../vendor/autoload.php';\r\n\t$config = array(\r\n\t\t'remote'\t=> array( // リモート側\r\n\t\t\t'Memcached' => array(\r\n\t\t\t\t'servers' => array(\r\n\t\t\t\t\tarray('localhost',11211), // memcachedのサーバ設定とおなじ\r\n\t\t\t\t),\r\n\t\t\t),\r\n\t\t),\r\n\t\t'local'\t\t=> array( // AP側(実行しているPHPの鯖)\r\n\t\t\t'Apc' => array(), // 別に設定は特になし、でも空配列じゃないとだめだよー\r\n\t\t),\r\n\t);\r\n\t\r\n\ttry { \r\n\t\t$cache = new Ultracache\\Ultracache($config);\r\n\t\t$cache->set('test','cachetest'); // キャッシュをセット\r\n\t\tvar_dump($cache->get('test')); // キャッシュをゲット\r\n\r\n\t} catch (Ultracache\\Exception\\NosupportDriverException $noe ) {\r\n\t\techo $noe->getMessage();\r\n\t\techo \"\\n\";\r\n\t}\r\n\r\nたぶん、サンプルを見ればわかるかと思います。\r\nキャッシュが無い場合はmemcachedとローカルのAPCキャッシュに保存して、キャッシュがローカルにある場合は、ローカルからのみキャッシュを取得して、ローカルに無い場合はmemcacheから取得して、ローカルのAPCにキャッシュを入れるような仕組みになっています。  \r\nほかのAPサーバとのキャッシュの同期とかはいれていないので、比較的変更の少ないデータをキャッシュすることをお勧めします。\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}